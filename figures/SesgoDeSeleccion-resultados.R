oldpar <- par(no.readonly = TRUE)
oldwd <- getwd()
this.dir <- dirname(parent.frame(2)$ofile)
setwd(this.dir)
nombre.R <-  sys.frame(1)$ofile
require(tools)
nombre <- print(file_path_sans_ext(nombre.R))
pdf(paste0(nombre,".pdf"), width = 8, height = 5 )
setwd(this.dir)
##################################################

s=matrix(nrow=9,ncol=3)
x=matrix(nrow=9,ncol=3)
p=matrix(nrow=10,ncol=3)

S <- c(0.8, 0.9, 0.95, 0.7 , 0.8 , 0.93, 0.89, 0.82, 0.999)
X <- c(0.9, 0.99, 0.95, 0.9, 0.65, 0.96, 0.91, 0.79, 0.999)
P <- seq(0.05,0.95,by=0.1)

s[1,]=c(0.7458699,0.7645492,0.7820884)
s[2,]=c(0.8541695,0.8689994,0.8833151)
s[3,]=c(0.9346696,0.9443477,0.9539212)
s[4,]=c(0.6881597,0.7086888,0.7272182)
s[5,]=c(0.7696950,0.7878262,0.8047055)
s[6,]=c(0.9251408,0.9355485,0.9460831)
s[7,]=c(0.8779058,0.8912309,0.9041704)
s[8,]=c(0.7951318,0.8117656,0.8279478)
s[9,]=c(0.9961301,0.9982447,0.9996466)
x[1,]=c(0.8738418,0.8887420,0.9022003)
x[2,]=c(0.9808676,0.9864003,0.9912786)
x[3,]=c(0.9219956,0.9337159,0.9445299)
x[4,]=c(0.8790224,0.8929592,0.9067267)
x[5,]=c(0.6316157,0.6529123,0.6742460)
x[6,]=c(0.9507515,0.9597916,0.9686402)
x[7,]=c(0.8990714,0.9118866,0.9243896)
x[8,]=c(0.7708159,0.7889918,0.8070603)
x[9,]=c(0.9973074,0.9990549,0.9999685)
p[1,]=c(0.3921526,0.4403474,0.4889286)
p[2,]=c(0.4409312,0.4897565,0.5387558)
p[3,]=c(0.4493299,0.4974151,0.5465650)
p[4,]=c(0.4528213,0.5001885,0.5500439)
p[5,]=c(0.4657094,0.5124182,0.5621103)
p[6,]=c(0.4534098,0.5028436,0.5522040)
p[7,]=c(0.4699391,0.5172199,0.5683641)
p[8,]=c(0.5009205,0.5494886,0.5968837)
p[9,]=c(0.5296878,0.5770874,0.6267200)
p[10,]=c(0.6587775,0.7039056,0.7474116)


#
# s[1,]=c(7.069791e-01,0.725283516,0.743657254,0.725309532,0.009406118)
# s[2,]=c(8.102056e-01,0.826081622,0.841413976,0.825962980,0.007982802)
# s[3,]=c(9.105069e-01,0.921762420,0.932654736,0.921619978,0.005684481)
# s[4,]=c(6.821986e-01,0.701173791,0.719742652,0.701058241,0.009621190)
# s[5,]=c(7.838625e-01,0.799458739,0.816571218,0.799469172,0.008393530)
# s[6,]=c(9.212992e-01,0.931555324,0.941741398,0.931450755,0.005254301)
# s[7,]=c(8.771016e-01,0.890154865,0.902587905,0.890014399,0.006512638)
# s[8,]=c(7.967512e-01,0.812894407,0.828600256,0.812776101,0.008137631)
# s[9,]=c(9.958984e-01,0.998078985,0.999616860,0.997927787,0.001021261)
# x[1,]=c(7.935955e-01,0.810895943,0.827071712,0.810690887,0.008504881)
# x[2,]=c(9.516622e-01,0.960169099,0.968092909,0.960033148,0.004231326)
# x[3,]=c(8.582522e-01,0.872615678,0.886749860,0.872473539,0.007250170)
# x[4,]=c(8.804333e-01,0.893875841,0.906495416,0.893756181,0.006659187)
# x[5,]=c(6.295643e-01,0.649810162,0.669565937,0.649670707,0.010261684)
# x[6,]=c(9.569691e-01,0.965320546,0.972551445,0.965176782,0.004009147)
# x[7,]=c(8.978066e-01,0.910291730,0.922083504,0.910102257,0.006215468)
# x[8,]=c(7.895851e-01,0.805953076,0.822975919,0.805898100,0.008575526)
# x[9,]=c(9.948151e-01,0.997259686,0.999186813,0.997114736,0.001177120)
# p[1,]=c(1.218932e-07,0.001782257,0.007480539,0.002532027,0.002466737)
# p[2,]=c(4.233527e-01,0.472582613,0.520781873,0.472490240,0.024978099)
# p[3,]=c(4.436145e-01,0.495238615,0.541349368,0.495116278,0.024894624)
# p[4,]=c(4.357994e-01,0.485125377,0.533242809,0.485087893,0.024800224)
# p[5,]=c(4.585363e-01,0.507703535,0.555725539,0.507565722,0.024784743)
# p[6,]=c(4.599666e-01,0.509621712,0.557660960,0.509877102,0.024928952)
# p[7,]=c(4.606280e-01,0.509944158,0.558767238,0.510075840,0.025079922)
# p[8,]=c(4.864956e-01,0.534602420,0.584441556,0.534576576,0.025125851)
# p[9,]=c(5.099342e-01,0.556971337,0.606241110,0.556953877,0.024600929)
# p[10,]=c(5.595405e-01,0.606975999,0.654833819,0.606972885,0.024431496)
# p[11,]=c(9.926180e-01,0.998296679,0.999999923,0.997555551,0.002411203)

plot(0,0,col=rgb(1,1,1,0),  ylim=c(0.65,1), xlim=c(1, 9+0.25), axes=F, xlab="", ylab="")
for (is in seq(length(S))){
    points(is, S[is], pch=19)
    text(is+0.3, S[is]+0.005,paste0("s",toString(is)), cex=1.25, col=rgb(0,0,0,0.6))
    segments(x0=is, x1=is, y0=s[is,1], y1=s[is,3],lwd=1)
    segments(x0=is-0.1, x1=is+0.1, y0=s[is,2], y1=s[is,2])
}
abline(v=3.5)
mtext(text ="Referencia",side =1,line=0,cex=1.33,at = 2.1)
axis(side=2, at= seq(0.65,1.0,by=0.05) ,labels=NA,cex.axis=0.6,tck=0.015)
#axis(side=1, labels=NA,cex.axis=0.6,tck=0.015)
#axis(lwd=0,side=1, cex.axis=1.5,line=-0.45)
axis(lwd=0,side=2,at= seq(0.65,1.0,by=0.05), cex.axis=1.5,line=-0.45)
abline(h=seq(0.65,1.0,by=0.05), col=rgb(0,0,0,0.1))



plot(0,0,col=rgb(1,1,1,0),  ylim=c(0.65,1), xlim=c(1, 9+0.25), axes=F, xlab="", ylab="")
for (ix in seq(length(X))){
    points(ix, X[ix], pch=19)
    text(ix+0.3,X[ix]+0.005,paste0("x",toString(ix)), cex=1.25, col=rgb(0,0,0,0.6))
    segments(x0=ix, x1=ix, y0=x[ix,1], y1=x[ix,3],lwd=1)
    segments(x0=ix-0.1, x1=ix+0.1, y0=x[ix,2], y1=x[ix,2])
}
abline(v=3.5)
mtext(text ="Referencia",side =1,line=0,cex=1.33,at = 2.1)
axis(side=2, at= seq(0.65,1.0,by=0.05) ,labels=NA,cex.axis=0.6,tck=0.015)
#axis(side=1, labels=NA,cex.axis=0.6,tck=0.015)
#axis(lwd=0,side=1, cex.axis=1.5,line=-0.45)
axis(lwd=0,side=2,at= seq(0.65,1.0,by=0.05), cex.axis=1.5,line=-0.45)
abline(h=seq(0.65,1.0,by=0.05), col=rgb(0,0,0,0.1))



plot(0,0,col=rgb(1,1,1,0),  ylim=c(0,1), xlim=c(1, 10+0.25), axes=F, xlab="", ylab="")
for (ix in seq(length(P))){
    points(ix, P[ix], pch=19)
    text(ix+0.3,P[ix]+0.005,paste0("p",toString(ix)), cex=1.25, col=rgb(0,0,0,0.6))
    segments(x0=ix, x1=ix, y0=p[ix,1], y1=p[ix,3],lwd=1)
    segments(x0=ix-0.1, x1=ix+0.1, y0=p[ix,2], y1=p[ix,2])
}
axis(side=2, at= seq(0.05,0.95,by=0.1) ,labels=NA,cex.axis=0.6,tck=0.015)
#axis(side=1, labels=NA,cex.axis=0.6,tck=0.015)
#axis(lwd=0,side=1, cex.axis=1.5,line=-0.45)
axis(lwd=0,side=2,at= seq(0.0,1.0,by=0.1), cex.axis=1.5,line=-0.45)
abline(h=seq(0.0,1.0,by=0.1), col=rgb(0,0,0,0.1))



######
dev.off()
system(paste("pdfcrop -m '0 0 0 0'",paste0(nombre,".pdf") ,paste0(nombre,".pdf")))
setwd(oldwd)
par(oldpar, new=F)

